# Alienvault OOSIM plugin
# Author: Kapistka Vladidmir at kapistka-at-gmail.com
# Plugin bro-ids id:1568 version: 0.0.2
# Last modification: 2016-04-25
#
# Plugin Selection Info:
# Bro:Bro NSM:-
#
# END-HEADER
# Accepted products:
# Bro - Bro NSM -
# Description:
# http://www.bro.org/index.html
#
#Bro-IDS must use default output
#Logs send via rsyslog
#"#11" use as delimiter in log-line

[DEFAULT]
plugin_id=1568

[config]
type=detector
enable=yes
source=log
location=/var/log/bro-ids.log
create_file=false

process=
start=no
stop=no
startup=
shutdown=



#notice-log

#Dec 14 00:01:43 broids bro_notice: 1450040494.683029#011CFk3Aa1bCe8jITxcI3#0111.1.1.1#01152235#0112.2.2.2#011443#011-#011-#011-#011tcp#011SSL::Invalid_Server_Cert#011SSL certificate validation failed with (unable to get local issuer certificate)#011CN=sls.update.microsoft.com,OU=DSP,O=Microsoft,L=Redmond,ST=Washington,C=US#0111.1.1.1#011157.56.77.138#011443#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011- 
[03 - Invalid Server Cert]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(\IPV4)#011(\d+)#011(\IPV4)#011(\d+)#011.*#011SSL::Invalid_Server_Cert#011.*)
plugin_sid=3
date={normalize_date($date)}
src_ip={$4}
src_port={$5}
dst_ip={$6}
dst_port={$7}
#userdata9={$userdata}

#Dec 14 00:07:14 broids bro_notice: 1450040826.500942#011-#011-#011-#011-#011-#011-#011-#011-#011tcp#011Scan::Address_Scan#0112.2.2.2 scanned at least 25 unique hosts on port 3389/tcp in 0m5s#011remote#011115.159.3.147#011-#0113389#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-  
[04 - Address Scan]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*#011Scan::Address_Scan#011(?P<src_ip>\IPV4) scanned at least \d+ unique hosts on port (?P<src_port>\d+).*)
plugin_sid=4
date={normalize_date($date)}
src_ip={$src_ip}
dst_port={$src_port}
#userdata9={$userdata}

#Dec 15 01:48:16 broids bro_notice: 1450133290.290782#011-#011-#011-#011-#011-#011-#011-#011-#011-#011Scan::Port_Scan#0112.2.2.2 scanned at least 15 unique ports of host 1.1.1.1 in 0m5s#011remote#0112.2.2.2#0111.1.1.1#011-#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011- 
[05 - Port Scan]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*#011Scan::Port_Scan#011(\IPV4) scanned at least \d+ unique ports of host (\IPV4) .*)
plugin_sid=5
date={normalize_date($date)}
src_ip={$4}
dst_ip={$5}
#userdata9={$userdata}

#Dec 28 11:48:14 broids bro_notice: 1451292491.606975#011-#011-#011-#011-#011-#011-#011-#011-#011-#011HTTP::SQL_Injection_Attacker#011An SQL injection attacker was discovered!#011-#0111.1.1.1#011-#011-#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[06 - SQL Injection Attacker]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*#011HTTP::SQL_Injection_Attacker#011An SQL injection attacker was discovered\!#011-#011(?P<src_ip>\IPV4)#011.*)
plugin_sid=6
date={normalize_date($date)}
src_ip={$src_ip}
#userdata9={$userdata}

#Dec 28 11:48:14 broids bro_notice: 1451292491.606975#011-#011-#011-#011-#011-#011-#011-#011-#011-#011HTTP::SQL_Injection_Victim#011An SQL injection victim was discovered!#011-#01181.161.116.154#011-#011-#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[07 - SQL Injection Victim]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*#011HTTP::SQL_Injection_Victim#011An SQL injection victim was discovered\!#011.*#011(?P<dst_ip>\IPV4)#011.*)
plugin_sid=7
date={normalize_date($date)}
dst_ip={$dst_ip}
#userdata9={$userdata}

#Feb 10 23:22:58 broids bro_notice: 1455135774.657983#011C7gH154Ksd90HYKgr#0112.2.2.2#01153561#0111.1.1.1#011443#011-#011-#011-#011tcp#011Weird::Activity#011SYN_after_partial#011-#0112.2.2.2#0111.1.1.1#011443#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[08 - SYN after partial]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(\IPV4)#011(\d+)#011(\IPV4)#011(\d+).*#011Weird::Activity#011SYN_after_partial#011.*)
plugin_sid=8
date={normalize_date($date)}
src_ip={$4}
src_port={$5}
dst_ip={$6}
dst_port={$7}
#userdata9={$userdata}

#Feb 11 17:02:06 broids bro_notice: 1455199320.551011#011-#011-#011-#011-#011-#011-#011-#011-#011-#011Traceroute::Detected#0111.1.1.1 seems to be running traceroute using icmp#011-#0111.1.1.1#011-#011-#011-#011bro#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011- 
[09 - Traceroute]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*#011Traceroute::Detected#011(\IPV4) .*)
plugin_sid=9
date={normalize_date($date)}
src_ip={$4}
#userdata9={$userdata}

#Feb 19 07:10:33 broids bro_notice: 1455855026.650910#011-#011-#011-#011-#011-#011-#011-#011-#011-#011SSH::Password_Guessing#0112.2.2.2 appears to be guessing SSH passwords (seen in 31 connections).#011Sampled servers:  1.1.1.1, 1.1.1.1, 1.1.1.2, 1.1.1.1, 1.1.1.1#0112.2.2.2#011-#011-#011-#011worker-2-2#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[010 - SSH::Password Guessing]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*#011SSH::Password_Guessing#011(?P<description>.*)#011(?P<sampled_servers>Sampled servers:.* (?P<dst_ip>\IPV4))#011(?P<src_ip>\IPV4)#011-#011.*)
plugin_sid=10
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$description}
userdata2={$sampled_servers}
#userdata9={$userdata}


#https://github.com/initconf/brocon-15/blob/master/sip-scans.bro

#Feb 22 16:28:35 broids bro_notice: 1456147706.728007#011CXId9US6fXalBeSOj#0112.2.2.2#01126810#0111.1.1.1#0115060#011-#011-#011-#011udp#011SIP::SipviciousScan#011Sipvicious Scan seen#011-#0112.2.2.2#0111.1.1.1#0115060#011-#011worker-2-1#011Notice::ACTION_LOG#01121600.000000#011F#011-#011-#011-#011-#011-
[011 - Sipvicious Scan]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011SIP::SipviciousScan#011.*)
plugin_sid=11
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}


#Feb 25 12:49:29 broids bro_notice: 1456393764.739242#011CpKTHh1d4PBElReIs7#0112.2.2.2#01152848#0112.2.2.1#0118080#011FHO8tb3TuurLLDlsK9#011application/x-dosexec#011http://www.site.com:8080/tcphttp://www.site.com/c?x=AV&downloadAs=downloader_for_Alcohol52_FE_2.0.3.8426.exe#011tcp#011TeamCymruMalwareHashRegistry::Match#011Malware Hash Registry Detection rate: 12%  Last seen: 2016-02-18 19:38:11#011https://www.virustotal.com/en/search/?query=5ea8fed152885a9ec3d7bc04e574d85ff459c87d#0112.2.2.2#0112.2.2.1#0118080#011-#011worker-1-1#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[012 - Virus]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[A-Za-z0-9]+#011(?P<file_type>.+?)#011(?P<url>.+?)#011[a-z]+#011TeamCymruMalwareHashRegistry::Match#011(?P<mhr>.*?)#011(?P<virustotal>.*?)#011(\IPV4)#011.*)
plugin_sid=12
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$file_type}
userdata2={$url}
userdata3={$mhr}
userdata4={$virustotal}
#userdata9={$userdata}


#Feb 26 07:28:27 broids bro_notice: 1456460906.486902#011CNtcvJ3zbbE9E2p1Z7#0112.2.2.2#01156488#0111.1.1.1#011443#011-#011-#011-#011tcp#011Heartbleed::SSL_Heartbeat_Attack#011An TLS heartbleed attack was detected! Record length 3. Payload length 16384#011-#0112.2.2.2#0111.1.1.1#011443#011-#011worker-1-2#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[013 - Heartbleed Attack]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011Heartbleed::SSL_Heartbeat_Attack#011.*)
plugin_sid=13
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}

#Feb 26 23:38:51 broids bro_notice: 1456519124.357539#011CiJvpsGhllf1jlgfj#0112.2.2.2#01156871#0111.1.1.1#011443#011-#011-#011-#011tcp#011Heartbleed::SSL_Heartbeat_Odd_Length#011Heartbeat message smaller than minimum required length. Probable attack. Message length: 48. Required length: 64. Cipher: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA. Cipher match: /^?(_256_CBC_SHA$)$?/#011-#0112.2.2.2#0111.1.1.1#011443#01148#011worker-2-6#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[014 - Heartbleed Probable Attack]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011Heartbleed::SSL_Heartbeat_Odd_Length#011.*)
plugin_sid=14
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}

#https://github.com/initconf/brocon-15/blob/master/sip-scans.bro

#Feb 26 23:38:51 broids bro_notice: 1456793007.797839#011C83p3n1v6FXYTMRNa2#0112.2.2.2#0115119#0111.1.1.1#0115060#011-#011-#011-#011udp#011SIP::SIP_403_Forbidden#011SIP bruteforce: 403 Forbidden#011-#0112.2.2.2#0111.1.1.1#0115060#011-#011worker-2-2#011Notice::ACTION_LOG#01121600.000000#011F#011-#011-#011-#011-#011-
[015 - SIP Bruteforce]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011SIP bruteforce: .*)
plugin_sid=15
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}

#https://github.com/michalpurzynski/bro-gramming/blob/master/verify_wpad.bro

#Feb 26 23:38:51 broids bro_notice: 1456869710.462704#011CYGtEy3SXSZKQ0Vj4j#0112.2.2.2#01150546#0112.2.2.1#01180#011-#011-#011-#011tcp#011MozillaVerifyWPAD::New_WPAD_In_HTTP#011Unauthorized WPAD detected#011Unknown HTTP server#0112.2.2.2#0112.2.2.1#01180#011-#
[016 - New WPAD in HTTP]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011MozillaVerifyWPAD::New_WPAD_In_HTTP#011.*)
plugin_sid=16
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}

[017 - New WPAD in DNS]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011MozillaVerifyWPAD::New_WPAD_In_DNS#011.*)
plugin_sid=17
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}


#https://github.com/michalpurzynski/bro-gramming/blob/master/dhcpr.bro

#Feb 26 23:38:51 broids bro_notice: 1456868791.123239#011C6BasOTNqPNFxYRze#0112.2.2.2#01167#011192.168.20.22#01167#011-#011-#011-#011udp#011UnauthorizedDHCP::ServerAck#011192.168.20.22 is sending unauthorized DHCP ack#011192.168.202.38#0112.2.2.2#011192.168.20.22#01167#011-#011worker-1-2#011Notice::ACTION_LOG#01186400.000000#011F#011-#011-#011-#011-#011-
[018 - DHCP::Unauthorized DHCP ack]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<ip_1>\IPV4)#011(?P<src_port>\d+)#011(?P<ip_2>\IPV4)#011(?P<dst_port>\d+)#011-#011-#011-#011udp#011UnauthorizedDHCP::ServerAck#011(?P<src_ip>\IPV4) is sending unauthorized DHCP ack#011(?P<dst_ip>\IPV4)#011.*)
plugin_sid=18
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$ip_1}
userdata2={$ip_2}
#userdata9={$userdata}

#https://github.com/michalpurzynski/bro-gramming/blob/master/dhcpr.bro

#Feb 26 23:38:51 broids bro_notice: 1456900889.875887#011ChJsxt4QFXFiYGlVL4#011192.168.202.1#01167#011192.168.20.23#01167#011-#011-#011-#011udp#011UnauthorizedDHCP::ServerOffer#011192.168.20.23 is sending unauthorized DHCP offers#011192.168.202.124#011192.168.202.1#011192.168.20.23#01167#011-#011worker-1-4#011Notice::ACTION_LOG#01186400.000000#011F#011-#011-#011-#011-#011-
[019 - DHCP::Unauthorized DHCP offers]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<ip_1>\IPV4)#011(?P<src_port>\d+)#011(?P<ip_2>\IPV4)#011(?P<dst_port>\d+)#011-#011-#011-#011udp#011UnauthorizedDHCP::ServerOffer#011(?P<src_ip>\IPV4) is sending unauthorized DHCP offers#011(?P<dst_ip>\IPV4)#011.*)
plugin_sid=19
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$ip_1}
userdata2={$ip_2}
#userdata9={$userdata}

#https://github.com/michalpurzynski/bro-gramming/blob/master/dhcpr.bro

#Feb 26 23:38:51 broids bro_notice: 1456900889.875887#011ChJsxt4QFXFiYGlVL4#011192.168.202.1#01167#011192.168.20.23#01167#011-#011-#011-#011udp#011UnauthorizedDHCP::ServerRoutersInOffer#011192.168.20.23 is sending suspicious DHCP router list - 192.168.202.1,#011192.168.20.23#011192.168.202.1#011192.168.20.23#01167#011-#011worker-1-4#011Notice::ACTION_LOG#01186400.000000#011F#011-#011-#011-#011-#011-
[020 - DHCP::Suspicious DHCP router list]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<ip_1>\IPV4)#011(?P<src_port>\d+)#011(?P<ip_2>\IPV4)#011(?P<dst_port>\d+)#011-#011-#011-#011udp#011UnauthorizedDHCP::ServerRoutersInOffer#011(?P<src_ip>\IPV4) is sending suspicious DHCP router list - (?P<dst_ip>\IPV4)\,.*)
plugin_sid=20
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$ip_1}
userdata2={$ip_2}
#userdata9={$userdata}


#https://github.com/michalpurzynski/bro-gramming/blob/master/sshverlong.bro

#Feb 26 23:38:51 broids bro_notice: 1456896364.795366#011C4x38j3eRiTXUlIb6#011192.168.20.40#01147620#01183.149.0.121#01122#011-#011-#011-#011tcp#011SSH_VER_LONG::ServerVersionStringLong#011192.168.20.40 seems to use a very long SSH server version.#011SSH-2.0-OpenSSH_5.0p1+sftpfilecontrol-v1.2-hpn13v1#011192.168.20.40#01183.149.0.121#01122#011-#011worker-1-1#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[021 - SSH::Server version long]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011SSH_VER_LONG::ServerVersionStringLong#011.*)
plugin_sid=21
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}

[022 - SSH::Client version long]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011SSH_VER_LONG::ClientVersionStringLong#011.*)
plugin_sid=22
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}



#Meterpreter detected
#https://github.com/fox-it/bro-scripts/blob/master/meterpreter.bro

#Feb 26 23:38:51 broids bro_notice: 1459776945.599333#011CwAFza4QS39oQBmRlj#0111.1.1.1#01151989#0112.2.2.2#0117002#011-#011-#011-#011tcp#011Metasploit::Meterpreter#011Possible Meterpreter Payload transfered!#011-#0111.1.1.1#0112.2.2.2#0117002#011-#011worker-2-4#011Notice::ACTION_LOG#0113600.000000#011F#011-#011-#011-#011-#011-
[023 - Meterpreter detected]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*#011Metasploit::Meterpreter#011.*)
plugin_sid=23
date={normalize_date($date)}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
#userdata9={$userdata}



#Dec 14 00:01:43 broids bro_notice: 
[099 - Generic Notice]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_notice: (?P<userdata>(?P<date>\S+)\.\d+#011.*)
plugin_sid=99
date={normalize_date($date)}
userdata9={$userdata}






#files-log

[translation]
HTTP=101
SMTP=102
FTP_DATA=103
SSL=104

#Dec 16 00:23:17 broids bro_files: 1458567891.012927#011FNG29ha5BAap3rDs8#011192.168.20.5#011192.168.214.109#011CbqoEG3P9I1KWbzN9f,CUmqZH18dScwI3V294#011HTTP#0110#011SHA1,MD5#011application/pdf#011-#0110.973292#011T#011F#011902200#011901863#0110#0110#011F#011-#011601544cd86e54665b302666483873702#0116f982a0f1c61b4c26830e2357c28c291dca871cd#011-#011-

#Dec 16 00:23:17 broids bro_files: 1450214595.486758#011FwNLoZ26WEJqJwpbGg#0112.2.2.2#0111.1.1.1#011CVd0p03a1B9KU1uA11#011HTTP#0110#011MD5,SHA1#011application/javascript#011-#0110.000000#011F#011F#011140#011140#0110#0110#011F#011-#01153e308f3ea321ec530ad68afcc24a048#011ec96af9b20d9a2e69398ee8195f8757ef7922b1b#011-#011-
[101 - File via Protocol]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_files: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(\IPV4)#011(\IPV4)#011[A-Za-z0-9\,]+#011(?P<rawsid>HTTP|SMTP|FTP_DATA|SSL)#011\d+#011[A-Za-z0-9\,]+#011(?P<filetype>.+?)#011.+?#011.+?#011.+?#011.+?#011.+?#011.+?#011.+?#011.+?#011.+?#011.+?#011(?P<MD5>[a-z0-9]+)#011.+?#011.+?#011.+?)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$4}
dst_ip={$5}
userdata1={$filetype}
userdata2={$MD5}
#userdata9={$userdata}


#Dec 16 09:08:26 broids bro_files: 1450246082.509035#011Fl94Cs4GIG9tKFLosd#0111.1.1.1#0112.2.2.2#011CweOrR312uVbiNX61h#011FTP_DATA#0110#011MD5,SHA1#011application/pdf#011-#0119.139095#011T#011F#0111302907#011-#0110#0110#011F#011-#011469f3f2eb1afabbfa96d65a92429b0c2#01129edadf89028bec3fa3345f6e121fa028c5ee961#011-#011-
[199 - File::Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_files: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(\IPV4)#011(\IPV4)#011.*)
plugin_sid=199
date={normalize_date($date)}
src_ip={$4}
dst_ip={$5}
userdata9={$userdata}



#smtp-log



#fields	ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	trans_depth	helo	mailfrom	rcptto	date	from	to	reply_to	msg_id	in_reply_to	subject	x_originating_ip	first_received	second_received	last_reply	path	user_agent	tls	fuids	is_webmail
#types	time	string	addr	port	addr	port	count	string	string	set[string]	string	string	set[string]	string	string	string	string	addr	string	string	string	vector[addr]	string	bool	vector[string]	bool

#Dec 17 12:30:16 broids bro_smtp: 1450344610.603445#011Cc2f1F4GzW4q4qc72d#0112.2.2.2#01164523#0111.1.1.1#01125#0111#011b2b-service.mx.com#011<b2b-info@mx.com>#011<test@company.com>#01117 Dec 2015 12:32:40 +0300#011b2b-info@mx.com#011test@company.com#011-#011<B2B-SERVICEDpubxcbz000d77fe@b2b-service.mx.com>#011-#011=?utf-8?B?Lg==?=#011-#011from b2b-service ([2.2.2.2]) by b2b-service.mx.com with Microsoft SMTPSVC(8.5.9600.16384);\x09 Thu, 17 Dec 2015 12:32:40 +0300#011-#011250 ok:  Message 6461428 accepted#0111.1.1.1,2.2.2.2#011-#011F#011F5JP6718RgGdGfRxg8#011F

#Feb 28 01:08:37 broids bro_smtp: 1456610901.113277#011Ca3SSZ2kWg582LQG8#0112.2.2.2#01140079#0111.1.1.1#01125#0111#011mail.mx.com#011<club@club.mx.com>#011<test@company.com>#011-#011-#011-#011-#011-#011-#011-#011-#011-#011-#011221 mx.org.com#0111.1.1.1,3.3.3.3#011-#011F#011FKg7oc1yJNrc7bKoz6#011F

[201 - SMTP-Message]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_smtp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<helo>.*?)#011(?P<mailfrom>.*?)#011(?P<rcptto>.*?)#011(?P<maildate>.*?)#011(?P<from_addr>.*?)#011(?P<to_addr>.*?)#011.*?#011(?P<msg_id>.*?)#011.*?#011(?P<subject>.*?)#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*)
plugin_sid=201
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$mailfrom}
userdata1={$to_addr}
userdata3={$helo}
userdata4={$from_addr}
userdata5={$rcptto}
userdata6={$maildate}
userdata7={$msg_id}
userdata8={$subject}
#userdata9={$userdata}



#ssh

#fields#011ts#011uid#011id.orig_h#011id.orig_p#011id.resp_h#011id.resp_p#011version#011auth_success#011direction#011client#011server#011cipher_alg#011mac_alg#011compression_alg#011kex_alg#011host_key_alg#011host_key#011remote_location.country_code#011remote_location.region#011remote_location.city#011remote_location.latitude#011remote_location.longitude

#Dec 14 06:37:10 broids bro_ssh: 1450064196.891505#011CO6LQatf5O8fkThhe#0112.2.2.2#01161748#0111.1.1.1#01122#0112#011-#011INBOUND#011SSH-2.0-JSCH-0.1.51#011SSH-2.0-OpenSSH_5.9#011aes128-ctr#011hmac-md5#011none#011diffie-hellman-group-exchange-sha1#011ssh-rsa#01111:22:33:c4:f5:66:77:88:99:10:11:12:13:14:15:16#011-#011-#011-#011-#011-

#Feb 25 00:12:21 broids bro_ssh: 1456348333.127843#011CxinGF7XYgGXPlAa6#011192.168.21.40#01146961#0111.1.1.1#0112222#0112#011-#011-#011SSH-2.0-OpenSSH_6.6 PKIX#011SSH-2.0-OpenSSH_6.6 PKIX#011-#011-#011-#011-#011-#011-#011-#011-#011-#011-#011-

[301 - SSH-connection]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_ssh: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011.*?#011.*?#011(?P<client>.*?)#011(?P<server>.*?)#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?)
plugin_sid=301
date={normalize_date($date)}client
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$client}
userdata2={$server}
#userdata9={$userdata}


#dns


#Dec 17 17:20:12 broids bro_dns: 1450362011.576870#011CrPRQB13rVXkP4N0j1#0111.1.1.1#01156547#0112.2.2.2#01153#011udp#01125680#011my.games.test.com#0111#011C_INTERNET#0111#011A#0110#011NOERROR#011F#011F#011T#011T#0111#01194.100.186.34#01160.000000#011F

#Dec 17 18:11:50 broids bro_dns: 1450365099.730481#011Cz7m6R27OlYW7Yd5b#0111.1.1.1#01158498#0112.2.2.2#01153#011udp#01150634#011wwwimages.adobe.com#0111#011C_INTERNET#0111#011A#0110#011NOERROR#011F#011F#011T#011T#0111#011wwwimages.wip4.adobe.com,wwwimages.adobe.com.edgesuite.net,wwwimages.adobe.com.edgesuite.net.globalredir.akadns.net,212.akamai.net,2.2.2.2,2.2.2.3#01160.000000,900.000000,21600.000000,3600.000000,20.000000,20.000000#011F

[401 - DNS]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dns: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dns_ip>\IPV4)#011(?P<dns_port>\d+)#011.*?#011.*?#011(?P<query>.*?)#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011.*?#011(?P<dst_ip>\IPV4)#011.*?#011.*)
plugin_sid=401
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
username={$query}
userdata1={$dns_ip}
#userdata9={$userdata}




#weird



[translation]
dns_unmatched_reply=501
NUL_in_line=502
data_before_established=503
possible_split_routing=504
window_recision=505
unescaped_special_URI_char=506
active_connection_reuse=507
SYN_seq_jump=508
SYN_inside_connection=509
above_hole_data_without_any_acks=510
premature_connection_reuse=511

#Feb 13 16:47:20 broids bro_weird: 1455371232.281966#011CPJlxD4J4e7sQ9BN0f#0111.1.1.1#01135087#0112.2.2.2#01153#011dns_unmatched_reply#011-#011F#011bro
[501 - Weird - DNS unmatched reply]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_weird: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<rawsid>\S+)#011.*)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
#userdata9={$userdata}


#Feb 13 16:47:20 broids bro_weird: 1455371232.281966#011CPJlxD4J4e7sQ9BN0f#0111.1.1.1#01135087#0112.2.2.2#01153#011dns_unmatched_reply#011-#011F#011bro
[599 - Weird - Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_weird: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=599
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}






#software




[translation]
Software::UNKNOWN=601
OS::WINDOWS=602
FTP::CLIENT=603
FTP::SERVER=604
HTTP::WEB_APPLICATION=605
HTTP::BROWSER_PLUGIN=606
HTTP::SERVER=607
HTTP::APPSERVER=608
HTTP::BROWSER=609
MySQL::SERVER=610
SMTP::MAIL_CLIENT=611
SMTP::MAIL_SERVER=612
SMTP::WEBMAIL_SERVER=613
SSH::SERVER=614
SSH::CLIENT=615


#Feb 15 10:59:13 broids bro_software: 1455523146.293166#0111.1.1.1#011-#011HTTP::BROWSER#011*BcfBAAAAGwBAAEFBAAAuD6RPSmBCJLPrPV#01179#011-#011-#011-#011MZNy2U3uVAAAnkiAAIAAKAA=#011*BcfBAAAAGwBAAEFBAAAuD6RPSmBCJLPrPV79MZNy2U3uVAAAnkiAAIAAKAA=

[600 - Software - HTTP browser - AAAAAAAAAAAAA]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_software: (?P<userdata>(?P<date>\S+)\.\d+#011(?P<src_ip>\IPV4)#011[0-9\-]+#011(?P<rawsid>[A-Za-z]+::[A-Z_]+)#011(?P<software>.*AAA.*?)#011.*)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
username='*AAA*'
#userdata9={$userdata}

#Feb 18 17:09:32 broids bro_software: 1455804562.247198#011192.168.11.97#011-#011HTTP::BROWSER#011Safari#0114#0110#011-#011-#011Mobile#011Mozilla/5.0 (Linux; Android 5.0.2; Redmi Note 2 Build/LRX22G; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/47.0.2526.100 Mobile Safari/537.36 (Mobile; afma-sdk-a-v6.0.1)

#Ends with "#011-"
#Feb 25 17:28:57 broids bro_software: 1456410531.467941#011192.168.208.12#011-#011HTTP::BROWSER#011Microsoft-CryptoAPI#0116#0111#011-#011-#011-#011Microsoft-CryptoAPI/6.1#011- 

#with pot
#Feb 26 15:43:41 broids bro_software: 1456490618.564373#0111.1.1.1#01180#011HTTP::WEB_APPLICATION#011Google Analytics#011-#011-#011-#011-#011-#011Google Analytics#011http://www.tillypad.ru/

[601 - Software - HTTP browser]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_software: (?P<userdata>(?P<date>\S+)\.\d+#011(?P<src_ip>\IPV4)#011[0-9\-]+#011(?P<rawsid>[A-Za-z]+::[A-Z_]+)#011(?P<software>.*?)#011.*?#011.*?#011.*?#011.*?#011.*?#011(?P<software_ver>.*?)#011.*)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
username={$software}
userdata1={$software_ver}
#userdata9={$userdata}

#Feb 15 10:59:13 broids bro_software: 1455523146.293166#0111.1.1.1#011-#011HTTP::BROWSER#011*BcfBAAAAGwBAAEFBAAAuD6RPSmBCJLPrPV#01179#011-#011-#011-#011MZNy2U3uVAAAnkiAAIAAKAA=#011*BcfBAAAAGwBAAEFBAAAuD6RPSmBCJLPrPV79MZNy2U3uVAAAnkiAAIAAKAA=

[699 - Software - Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_software: (?P<userdata>(?P<date>\S+)\.\d+#011(?P<src_ip>\IPV4)#011.*)
plugin_sid=699
date={normalize_date($date)}
src_ip={$src_ip}
userdata9={$userdata}





#dpd

#Feb 15 17:04:52 broids bro_dpd: 1455545084.152485#011CiOkNv31cREKftULt7#0111.1.1.1#01148758#0112.2.2.2#011443#011tcp#011SSL#011Invalid version in TLS connection. Version: 3596
#Feb 15 17:04:52 broids bro_dpd: 1456726166.776073#011Cqv1mY2xfGmgmQZLt8#0111.1.1.1#01142871#0112.2.2.2#011443#011tcp#011SSL#011Invalid version late in TLS connection. Packet reported version: 21328
[701 - DPD (protocol violations) - SSL::Invalid version in TLS connection]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SSL)#011Invalid .* TLS.*)
plugin_sid=701
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 27 13:38:42 broids bro_dpd: 1456569511.006941#011CPRhnh1uBVLZgqe5be#011192.168.20.5#01111540#0112.2.2.2#011443#011tcp#011SSL#011Invalid headers in SSL connection. Head1: 50, head2: 141, head3: 180
[702 - DPD (protocol violations) - SSL::Invalid headers in SSL connection]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SSL)#011Invalid headers in SSL.*)
plugin_sid=702
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 15 17:09:43 broids bro_dpd: 1455545374.739304#011C5dOVk4BUbdwhXlRpg#0111.1.1.1#01156345#0112.2.2.2#01180#011tcp#011HTTP#011not a http reply line
#Feb 15 17:09:43 broids bro_dpd: 1456725532.028815#011Cqgk8o3ZXS7C89mezj#0112.2.2.2#01159628#0111.1.1.1#01180#011tcp#011HTTP#011not a http request line
[703 - DPD (protocol violations) - HTTP::Not a http line]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>HTTP)#011not a http (request|reply) line)
plugin_sid=703
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 19 10:38:18 broids bro_dpd: 1455867494.234778#011C6GRP31a6MdxD3Pz31#011192.168.208.10#01139060#011192.168.20.33#01125#011tcp#011SMTP#011reply code -1 out of range [\\x16\\x03\\x01\\x08\\xc8\\x02\\x00Q\\x03\\x01V\\xc6\\xc6m\\xe2]
[704 - DPD (protocol violations) - SMTP::Reply code out of range]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SMTP)#011reply code.*out of range.*)
plugin_sid=704
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 00:12:21 broids bro_dpd: 1456348331.974545#011CHnVzD3G7HSi1bG7O5#011192.168.15.23#0112811#011192.168.20.33#01125#011tcp#011FTP#011non-numeric reply code [GET /]
[705 - DPD (protocol violations) - FTP::Non-numeric reply code]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>FTP)#011non\-numeric reply code.*)
plugin_sid=705
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1456422465.405180#011CUf6264ay0pND5heca#0111.1.1.1#01159361#0112.2.2.2#01156701#011udp#011DTLS#011Invalid version in DTLS connection. Packet reported version: 256
[706 - DPD (protocol violations) - DTLS::Invalid version]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>DTLS)#011Invalid version in DTLS.*)
plugin_sid=706
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1456728671.977014#011Cw3qLA1tuHwtYd649d#011192.168.20.5#01159047#0112.2.2.2#011443#011tcp#011SSL#011Invalid version in SSL client hello. Version: 2809
[707 - DPD (protocol violations) - SSL::Invalid version in SSL client hello]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SSL)#011Invalid version in SSL client hello.*)
plugin_sid=707
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1456896460.105266#011Cm9X1u4lA44SYol4L3#011192.168.15.23#0116667#011192.168.35.16#011443#011tcp#011IRC#011line too short
[708 - DPD (protocol violations) - IRC::line too short]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>IRC)#011line too short)
plugin_sid=708
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1458809248.847514#011C5GZpo9AfaWdBr8l8#0112.2.2.2#01159678#0111.1.1.1#011161#011udp#011SNMP#011binpac exception: Got ASN.1 tag 0, expect 48
[709 - DPD (protocol violations) - SNMP::binpac exception]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SNMP)#011binpac exception.*)
plugin_sid=709
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1458314759.936181#011CgfNZr1SVLTxsDGsok#011192.168.51.156#0115060#011192.168.102.143#0115060#011udp#011SIP#011Binpac exception: binpac exception: string mismatch at /root/bro-2.4.1/src/analyzer/protocol/sip/sip-protocol.pac:21: \x0aexpected pattern: "[^()<>@,;:\\"/\\[\\]?={} \\t]+"\x0aactual data: ""
[710 - DPD (protocol violations) - SIP::binpac exception]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SIP)#011Binpac exception.*)
plugin_sid=710
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1458213810.151302#011CJFIha4Bvd3S891KD5#011192.168.11.104#01136847#0112.2.2.2#0111812#011udp#011RADIUS#011Binpac exception: binpac exception: out_of_bound: RADIUS_Attribute:value: 171 > 2
[711 - DPD (protocol violations) - RADIUS::binpac exception]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>RADIUS)#011Binpac exception.*)
plugin_sid=711
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1459834193.662471#011CQ4LbQ2hwCioXVG6T9#0112.2.2.2#0116667#0111.1.1.1#01125#011tcp#011IRC#011invalid reply number
[712 - DPD (protocol violations) - IRC::invalid reply number]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>IRC)#011invalid reply number)
plugin_sid=712
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1461335529.711034#011CTTddXCDvJjLcCZ92#011192.168.20.5#01129213#0112.2.2.2#011443#011tcp#011SSL#011unsupported server SSL version 0x0307
[713 - DPD (protocol violations) - SSL::Unsupported server SSL version]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>SSL)#011unsupported server SSL version.*)
plugin_sid=713
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#Feb 25 20:47:55 broids bro_dpd: 1461501808.218661#011CNSlRv2bSo3RWoqXm9#0112.2.2.2#0114500#0111.1.1.1#0114500#011udp#011TEREDO#011Bad Teredo encapsulation [\\xff]
[714 - DPD (protocol violations) - TEREDO::Bad Teredo encapsulation]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>TEREDO)#011Bad Teredo encapsulation.*)
plugin_sid=714
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

#1461531773.299134#011CtEB1U2xKv95v1Da13#0112.2.2.2#01156014#0111.1.1.1#01153#011udp#011DNS#011DNS_Conn_count_too_large
[715 - DPD (protocol violations) - DNS::DNS Conn count too large]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011[a-z]+#011(?P<protocol>DNS)#011DNS_Conn_count_too_large)
plugin_sid=715
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
#userdata9={$userdata}

[799 - DPD (protocol violations) - Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_dpd: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=799
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}





#ftp

[translation]
APPE=801
DELE=802
RETR=803
STOR=804
STOU=805
ACCT=806
PORT=807
PASV=808
EPRT=809
EPSV=810

#Feb 26 15:30:48 broids bro_ftp: 1456489841.349329#011CvCXlRU22oHH62fh2#0112.2.2.2#01161696#0111.1.1.1#01121#011test#011password#011PASV#011-#011-#011-#011227#011Entering Passive Mode (89,22,216,151,19,186)#011T#01187.249.206.96#0111.1.1.1#0115050#011FRUJq54JXZvXXhjWp6

#Feb 15 17:17:44 broids bro_ftp: 1455545854.435127#011CuBM0l4hDsGxw9mYog#0111.1.1.1#01147467#01192.63.103.43#01121#011cgftp#011<hidden>#011PASV#011-#011-#011-#011227#011Entering Passive Mode (92,63,103,43,230,153)#011T#0111.1.1.1#01192.63.103.43#01159033#011-
[801 - FTP::]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_ftp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<username>.*?)#011(?P<password>.*?)#011(?P<rawsid>APPE|DELE|RETR|STOR|STOU|ACCT|PORT|PASV|EPRT|EPSV)#011.*)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
password={$password}
#userdata9={$userdata}


#Feb 15 17:18:34 broids bro_ftp: 1455545854.435127#011CuBM0l4hDsGxw9mYog#0111.1.1.1#01147467#01192.63.103.43#01121#011cgftp#011<hidden>#011RETR#011ftp://2.2.2.2/.//pb.cg#011<unknown>#0111234#011226#011Successfully transferred "//pb.cg"#011-#011-#011-#011-#011FV8FQ13OYVz0lUBmUg
[899 - FTP::Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_ftp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=899
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}





#sip





[translation]
CANCEL=901
INVITE=902
ACK=903
OPTIONS=904
BYE=905
REGISTER=906


#Feb 16 10:03:02 broids bro_sip: 1455606115.281981#011Co8Uww17qYQ9bljjqd#0111.1.1.1#01150868#0112.2.2.2#0115060#0110#011INVITE#011sip:1234567@2.2.2.2:5060#011Tue, 16 Feb 2016 08:22:38 GMT#011"Test Test" <sip:7654321@1.1.1.1>#011<sip:1234567@2.2.2.2>#011-#011-#011-#01112345678-D3123456-123456E7-12345678@1.1.1.1#011101 INVITE#011-#011SIP/2.0/UDP 1.1.1.1:5060,SIP/2.0/UDP 1.1.1.1:5060,SIP/2.0/UDP 1.1.1.1:5060#011(empty)#011Cisco-SIPGateway/IOS-12.x#011-#011-#011-#011250#011-#011-

#Feb 16 10:01:11 broids bro_sip: 1455606006.476981#011CCCKsx2beZU8WpMA57#0112.2.2.2#0115076#0111.1.1.1#0115060#0110#011INVITE#011sip:12345678987654321@vcse.com#011-#011test<sip:test@vcse.com>#01112345678987654321<sip:123456789987654321@vcse.com>#011-#011-#011-#01128cd6fae3e6a720a71ebbb5db0ddacd7#0111 INVITE#011-#011SIP/2.0/UDP 2.2.2.2:5076#011(empty)#011sipcli/v1.8#011-#011-#011-#011282#011-#011-

[901 - SIP::]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_sip: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<rawsid>CANCEL|INVITE|ACK|OPTIONS|BYE|REGISTER)#011(?P<uri>.*?)#011.*?#011(?P<username_from>.*?)#011(?P<username_to>.*?)#011.*)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username_from}
userdata1={$username_to}
userdata2={$uri}
#userdata9={$userdata}

#Bad rawsid
#Feb 17 15:59:35 broids bro_sip: 1455713959.548077#011CLNKOG2RymYUxSMXHd#0112.2.2.2#0115084#0111.1.1.1#01153#0110#011OP\xd4\x04ONS#011sip:test@1.1.1.1#011-#011"sipvicious"<sip:100@1.1.1.1>#011"sipvicious"<sip:test@1.1.1.1>#011-#011-#011-#01112345678987654321#0111 OPTIONS#011-#011SIP/2.0/UDP 2.2.2.2:5084,SIP/2.0/UDP 2.2.2.2:5084#011(empty)#011friendly-scanner#011-#011-#011-#0110#011-#011-

#Empty rawsid
#Feb 16 18:11:51 broids bro_sip: 1455635508.539930#011CUfyQH2WspctlyPTp7#0112.2.2.2#0115060#0111.1.1.1#0115060#0110#011-#011-#011-#011-#011-#011"Test Test" <sip:123456789@1.1.1.1>#011<sip:987654321@2.2.2.2>;tag=12345678-A9123456-#011-#011-#011-#011(empty)#011SIP/2.0/UDP 1.1.1.1:5060#011-#011100#011Trying#011-#011-#0110#011-

[907 - SIP::Unknown]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_sip: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011-#011(?P<uri>.*?)#011.*?#011(?P<username_from>.*?)#011(?P<username_to>.*?)#011.*)
plugin_sid=907
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username_from}
userdata1={$username_to}
userdata2={$uri}
#userdata9={$userdata}



[999 - SIP::Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_sip: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=999
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}





#rdp




#Feb 16 10:53:38 broids bro_rdp: 1455609202.076263#011CBpf3G4DmQz1yyeG94#0111.1.1.1#01155690#0112.2.2.2#0113389#011test#011encrypted#011HYBRID_EX#011-#011-#011-#011-#011-#011-#011-#011-#0110#011-#011-#011-

#Feb 16 10:39:56 broids bro_rdp: 1455608377.087632#011CbVJ7z4bxAh3JhD565#0111.1.1.1#01160335#0112.2.2.2#01155100#011test#011encrypted#011HYBRID_EX#011-#011-#011-#011-#011-#011-#011-#011-#0110#011-#011-#011-

#Feb 16 10:39:56 broids bro_rdp: 1456497826.841008#011CTQ6k7289iFhnmSQtj#011192.168.59.132#01158750#0112.2.2.2#0113389#011test#011-#011-#011-#011-#011-#011-#011-#011-#011-#011-#0110#011-#011-#011-

#Feb 16 10:39:56 broids bro_rdp: 1456834696.877886#011CPQNIs1OePm22gag56#011192.168.59.57#01150909#0112.2.2.2#0113389#011test#011-#011-#011-#011-#011-#011-#011-#011-#011-#011-#0110#011-#011-#011-

[1001 - RDP]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_rdp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<username>.+?)#011(encrypted|\-)#011.*)
plugin_sid=1001
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
#userdata9={$userdata}


#Feb 16 10:39:56 broids bro_rdp: 1456845421.498264#011CDgELq4HNU8ukEZjD5#0111.1.1.1#01156703#0112.2.2.2#0113389#011-#011Success#011RDP#011English - United States#011RDP 8.1#011HostName#011123456-4421-4a46-a200-76123456#0111280#0111024#01132bit#011RSA#0111#011T#011Client compatible#011128bit

#Feb 16 10:39:56 broids bro_rdp: 1458718154.632973#011ChiaJQ3acRFZ3W48bc#011192.168.10.180#01164532#011192.168.38.112#0113389#011test#011Success#011RDP#011English - United States#011client_build-10586#011Test#0111265ad2-4f25-4e12-8620-123456#0111920#0111080#01116bit#011RSA#0111#011T#011Client compatible#011128bit

#Feb 16 10:39:56 broids bro_rdp: 1458714505.774181#011CUe191ZSJJjyLAhAg#011192.168.10.180#01159161#011192.168.38.112#0113389#011-#011Success#011RDP#011Russian#011client_build-10586#011test#011123456-4f20-4e40-1234-1234ef2#0111920#0111080#01132bit#011RSA#0111#011T#011Client compatible#011128bit

[1002 - RDP::Info]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_rdp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<username>.+?)#011[A-Za-z]+#011RDP#011(?P<languige>[A-Za-z\s\-\.]+)#011(?P<version>[A-Za-z0-9_\s\-\.]+)#011(?P<hostname>[A-Za-z0-9\-\.]+)#011(?P<rdp_id>[A-Za-z0-9\-]+)#011.*)
plugin_sid=1002
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
userdata1={$languige}
userdata2={$version}
userdata3={$hostname}
userdata4={$rdp_id}
#userdata9={$userdata}

[1099 - RDP::Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_rdp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=1099
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}





#snmp

#Feb 16 11:21:51 broids bro_snmp: 1455610843.212071#011CEa4Tu432IfRkkHYL4#0112.2.2.2#01151351#0111.1.1.1#011161#0110.000000#0112c#011public#0111#0111#0110#0110#011-#011-

#Feb 16 11:21:51 broids bro_snmp: 1456730805.586416#011CMKsrQ13Hzz66VcOg1#0111.1.1.1#01144373#011192.168.18.200#011161#0117.501349#0113#011-#0110#0110#0110#0110#011-#011-

[1101 - SNMP]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_snmp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+\.\d+#011[A-Zz-z0-9]+#011(?P<community>[A-Zz-z0-9\-\s]+)#011.*)
plugin_sid=1101
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$community}
#userdata9={$userdata}

#Feb 16 11:21:51 broids bro_snmp: 1455610843.212071#011CEa4Tu432IfRkkHYL4#0112.2.2.2#01151351#0111.1.1.1#011161#0110.000000#0112c#011public#0111#0111#0110#0110#011-#011-
[1199 - SNMP::Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_snmp: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+).*)
plugin_sid=1199
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}





#tunnel

#tunnel types

#Tunnel::AYIYA
#Tunnel::NONE
#Tunnel::IP
#Tunnel::TEREDO
#Tunnel::SOCKS
#Tunnel::GTPv1
#Tunnel::HTTP
#Tunnel::GRE

[translation]
Tunnel::DISCOVER=1201
Tunnel::CLOSE=1202
Tunnel::EXPIRE=1203

#Feb 16 11:34:13 broids bro_tunnel: 1455611651.347395#011CcDNDVE0712HpK7Zh#0111.1.1.1#01155686#0112.2.2.2#0113544#011Tunnel::TEREDO#011Tunnel::CLOSE

[1201 - Tunnel::]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_tunnel: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<username>Tunnel::[A-Za-z0-9]+)#011(?P<rawsid>Tunnel::[A-Za-z0-9]+))
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
#userdata9={$userdata}

[1299 - Tunnel::Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_tunnel: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=1299
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}





#kerberos
[translation]
KDC_ERR_NONE=1303
KDC_ERR_NAME_EXP=1304
KDC_ERR_SERVICE_EXP=1305
KDC_ERR_BAD_PVNO=1306
KDC_ERR_C_OLD_MAST_KVNO=1307
KDC_ERR_S_OLD_MAST_KVNO=1308
KDC_ERR_C_PRINCIPAL_UNKNOWN=1309
KDC_ERR_S_PRINCIPAL_UNKNOWN=1310
KDC_ERR_PRINCIPAL_NOT_UNIQUE=1311
KDC_ERR_NULL_KEY=1312
KDC_ERR_CANNOT_POSTDATE=1313
KDC_ERR_NEVER_VALID=1314
KDC_ERR_POLICY=1315
KDC_ERR_BADOPTION=1316
KDC_ERR_ETYPE_NOTSUPP=1317
KDC_ERR_SUMTYPE_NOSUPP=1318
KDC_ERR_PADATA_TYPE_NOSUPP=1319
KDC_ERR_TRTYPE_NO_SUPP=1320
KDC_ERR_CLIENT_REVOKED=1321
KDC_ERR_SERVICE_REVOKED=1322
KDC_ERR_TGT_REVOKED=1323
KDC_ERR_CLIENT_NOTYET=1324
KDC_ERR_SERVICE_NOTYET=1325
KDC_ERR_KEY_EXPIRED=1326
KDC_ERR_PREAUTH_FAILED=1327
KDC_ERR_PREAUTH_REQUIRED=1328
KDC_ERR_SERVER_NOMATCH=1329
KDC_ERR_SVC_UNAVAILABLE=1330
KRB_AP_ERR_BAD_INTEGRITY=1331
KRB_AP_ERR_TKT_EXPIRED=1332
KRB_AP_ERR_TKT_NYV=1333
KRB_AP_ERR_REPEAT=1334
KRB_AP_ERR_NOT_US=1335
KRB_AP_ERR_BADMATCH=1336
KRB_AP_ERR_SKEW=1337
KRB_AP_ERR_BADADDR=1338
KRB_AP_ERR_BADVERSION=1339
KRB_AP_ERR_MSG_TYPE=1340
KRB_AP_ERR_MODIFIED=1341
KRB_AP_ERR_BADORDER=1342
KRB_AP_ERR_BADKEYVER=1343
KRB_AP_ERR_NOKEY=1344
KRB_AP_ERR_MUT_FAIL=1345
KRB_AP_ERR_BADDIRECTION=1346
KRB_AP_ERR_METHOD=1347
KRB_AP_ERR_BADSEQ=1348
KRB_AP_ERR_INAPP_CKSUM=1349
KRB_AP_PATH_NOT_ACCEPTED=1350
KRB_ERR_RESPONSE_TOO_BIG=1351
KRB_ERR_GENERIC=1352
KRB_ERR_FIELD_TOOLONG=1353
KDC_ERR_CLIENT_NOT_TRUSTED=1354
KDC_ERR_KDC_NOT_TRUSTED=1355
KDC_ERR_INVALID_SIG=1356
KDC_ERR_KEY_TOO_WEAK=1357
KRB_AP_ERR_USER_TO_USER_REQUIRED=1358
KRB_AP_ERR_NO_TGT=1359
KDC_ERR_WRONG_REALM=1360


#Feb 18 17:26:05 broids bro_kerberos: 1455805564.286596#011CcZuMp2DqPUt9AIJ2l#011192.168.220.184#01164037#011192.168.20.23#01188#011TGS#011Test/company.com#011HTTP/mx.company.com#011T#011-#011-#0112136422885.000000#011aes256-cts-hmac-sha1-96#011T#011T#011-#011-#011-#011-

#Feb 26 15:50:03 broids bro_kerberos: 1456490992.460155#011CM2KQ744x4voxLrJSk#011192.168.202.43#01150986#011192.168.20.22#01188#011TGS#011-#011hostname$@company.com#011-#011-#011-#0112136422885.000000#011-#011T#011T#011-#011-#011-#011-

[1301 - Kerberos Success]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_kerberos: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<req_type>AS|TGS|\-)#011(?P<username>.+?)#011(?P<service>.+?)#011T#011.*?#011.*?#011(?P<till_date>\S+)\.\d+#011.*)
plugin_sid=1301
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
userdata1={$req_type}
userdata2={$service}
userdata3={normalize_date($till_date)}
#userdata9={$userdata}

#Apr  5 21:13:37 broids bro_kerberos: 1459880003.723508#011CdrT7e4WXk1cEVbp64#011192.168.10.173#01152433#011192.168.20.22#01188#011AS#011hostname$/company.com#011krbtgt/company.com#011-#011-#011-#0112136422885.000000#011-#011T#011T#011-#011-#011-#011-

[1302 - Kerberos Unknown]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_kerberos: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<req_type>AS|TGS|\-)#011(?P<username>.+?)#011(?P<service>.+?)#011-#011-#011-#011((?P<till_date>\S+)\.\d+|\-)#011.*)
plugin_sid=1302
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
userdata1={$req_type}
userdata2={$service}
userdata3={normalize_date($till_date)}
#userdata9={$userdata}

#Apr  6 00:56:47 broids bro_kerberos: 1459893400.742550#011CUQwKE4wTahSUrgJPe#011192.168.10.194#01150033#011192.168.20.22#01188#011AS#011test/company.com#011krbtgt/company.com#011F#011KDC_ERR_C_PRINCIPAL_UNKNOWN#011-#0112136422885.000000#011-#011T#011T#011-#011-#011-#011-
[1303-1360 - Kerberos Errors]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_kerberos: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011(?P<req_type>AS|TGS|\-)#011(?P<username>.+?)#011(?P<service>.+?)#011F#011(?P<rawsid>[A-Z_]+)#011.*?#011(?P<till_date>\S+)\.\d+#011.*)
plugin_sid={translate($rawsid)}
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
userdata1={$req_type}
userdata2={$service}
userdata3={normalize_date($till_date)}
#userdata9={$userdata}


[1399 - Kerberos - Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_kerberos: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=1399
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}



#socks


#Feb 19 11:08:33 broids bro_socks: 1455869311.429300#011CBgBS62Ym4JICCtLC#011192.168.202.48#01149388#011192.168.20.35#01162911#0115#011-#011-#011succeeded#011-#011-#011-#011-#011\x00\x00\x00k\x00)\x00\x03\x00\x00\x00\xd0\x15\xd0\x15}#01134306
[1401 - Socks succeed]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_socks: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011-#011-#011succeeded#011.*)
plugin_sid=1401
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
#userdata9={$userdata}

#Feb 19 11:08:33 broids bro_socks: 1455869311.429300#011CBgBS62Ym4JICCtLC#011192.168.202.48#01149388#011192.168.20.35#01162911#0115#011-#011-#011succeeded#011-#011-#011-#011-#011\x00\x00\x00k\x00)\x00\x03\x00\x00\x00\xd0\x15\xd0\x15}#01134306
[1402 - Socks with credentials succeed]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_socks: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<username>.+?)#011(?P<password>.+?)#011succeeded#011.*)
plugin_sid=1402
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
password={$password}
#userdata9={$userdata}

#Feb 19 11:08:33 broids bro_socks: 1457088765.597973#011CMRXZY38nTKLLASPh2#011192.168.229.140#01157881#011192.168.20.21#01149165#0115#011-#011-#011unknown-4#011-#011-#011-#0112.2.2.2#011-#011127
[1403 - Socks no succeed]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_socks: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011-#011-#011[a-z0-9\-]+#011.*)
plugin_sid=1403
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
#userdata9={$userdata}

#Feb 19 11:08:33 broids bro_socks: 1457088765.597973#011CMRXZY38nTKLLASPh2#011192.168.229.140#01157881#011192.168.20.21#01149165#0115#011-#011-#011unknown-4#011-#011-#011-#0112.2.2.2#011-#011127
[1404 - Socks with credentials no succeed]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_socks: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<username>.+?)#011(?P<password>.+?)#011[a-z0-9\-]+#011.*)
plugin_sid=1404
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
password={$password}
#userdata9={$userdata}

#Feb 19 11:08:33 broids bro_socks: 1455869311.429300#011CBgBS62Ym4JICCtLC#011192.168.202.48#01149388#011192.168.20.35#01162911#0115#011-#011-#011succeeded#011-#011-#011-#011-#011\x00\x00\x00k\x00)\x00\x03\x00\x00\x00\xd0\x15\xd0\x15}#01134306
[1499 - Socks - Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_socks: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=1499
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}




#HTTP

#Feb 19 17:28:25 broids bro_http: 1455892100.777274#011CBohzJ3p5C6FvSpHP8#011192.168.59.143#01151196#01110.99.54.139#01113081#0115#011POST#01110.99.54.139#011/test/test#011-#011Java/1.7.0_67#011541#011586#011200#011OK#011-#011-#011-#011(empty)#011-#011-#011-#011FdXCPn4BemUuvmgQ97#011-#011FexT4g45MZqnvcMfs3#011-
[1501 - HTTP]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_http: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<method>[A-Z]+)#011(?P<host>.+?)#011(?P<uri>.+?)#011.*?#011\(empty\)#011-#011-#011.*)
plugin_sid=1501
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$method}
userdata2={$host}
userdata3={$uri}
#userdata9={$userdata}


#Feb 19 17:28:25 broids bro_http: 1455892100.777274#011CBohzJ3p5C6FvSpHP8#011192.168.59.143#01151196#01110.99.54.139#01113081#0115#011POST#01110.99.54.139#011/test/test#011-#011Java/1.7.0_67#011541#011586#011200#011OK#011-#011-#011-#011(empty)#011Username#011-#011-#011FdXCPn4BemUuvmgQ97#011-#011FexT4g45MZqnvcMfs3#011-
[1502 - HTTP with credentials]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_http: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<method>[A-Z]+)#011(?P<host>.+?)#011(?P<uri>.+?)#011.*?#011\(empty\)#011(?P<username>.+?)#011(?P<password>.+?)#011.*)
plugin_sid=1502
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$username}
password={$password}
userdata1={$method}
userdata2={$host}
userdata3={$uri}
#userdata9={$userdata}

#Mar 25 15:13:07 broids bro_http: 1458907986.533689#011Cm79ys43utTpm9PVW6#011192.168.51.101#01156269#011192.168.102.218#01180#0111#011GET#011192.168.102.218#011/test/test.php?ver=3.0.1&lang=en_GB&showGuiMessaging=1&files[]=multiselect.js&files[]=servercheck.js#011http://192.168.102.218/test/test.php?ddreset=1#011Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36#0110#0110#011304#011Not Modified#011-#011-#011-#011HTTP::URI_SQLI#011-#011-#011-#011-#011-#011-#011- 
[1503 - HTTP::SQL Injection]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_http: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011\d+#011(?P<method>[A-Z]+)#011(?P<host>.+?)#011(?P<uri>.+?)#011.*?#011HTTP::URI_SQLI#011.*)
plugin_sid=1503
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$method}
userdata2={$host}
userdata3={$uri}
#userdata9={$userdata}

#Feb 19 17:28:25 broids bro_http: 1455892100.777274#011CBohzJ3p5C6FvSpHP8#011192.168.59.143#01151196#01110.99.54.139#01113081#0115#011POST#01110.99.54.139#011/test/test#011-#011Java/1.7.0_67#011541#011586#011200#011OK#011-#011-#011-#011(empty)#011Username#011-#011-#011FdXCPn4BemUuvmgQ97#011-#011FexT4g45MZqnvcMfs3#011-
[1599 - HTTP - Generic]
event_type=event
regexp=(\SYSLOG_DATE)\s+\S+\s+bro_http: (?P<userdata>(?P<date>\S+)\.\d+#011[A-Za-z0-9]+#011(?P<src_ip>\IPV4)#011(?P<src_port>\d+)#011(?P<dst_ip>\IPV4)#011(?P<dst_port>\d+)#011.*)
plugin_sid=1599
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata9={$userdata}






